{"id":"mealfinding-cdn-12w","title":"Documentation - Terraform README with setup and troubleshooting","description":"## Requirements\nCreate `terraform/README.md` with:\n- Prerequisites section (fly CLI, terraform, Fastly API key)\n- Initial setup instructions (Tigris bucket, env vars)\n- Terraform workflow (init, plan, apply)\n- DNS configuration guide (CNAME records, TLS validation)\n- Caching strategy documentation (TTL table)\n- Troubleshooting section\n\n## Acceptance Criteria\n- [ ] README lists all prerequisites\n- [ ] README has step-by-step setup instructions\n- [ ] README documents required environment variables\n- [ ] README explains DNS CNAME configuration\n- [ ] README includes caching strategy table\n- [ ] README has troubleshooting for common issues\n\n## Context\nOpenSpec: add-fastly-cdn-terraform, Section 5\nParent Epic: mealfinding-cdn-995","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T18:15:13.060409838-08:00","created_by":"sword","updated_at":"2026-01-04T18:15:13.060409838-08:00"}
{"id":"mealfinding-cdn-1aq","title":"Validation - terraform fmt, validate, and plan","description":"## Requirements\n- Run `terraform fmt` to format configuration\n- Run `terraform validate` to check syntax\n- Run `terraform plan` to preview changes (requires credentials)\n\n## Acceptance Criteria\n- [ ] All .tf files pass `terraform fmt` check\n- [ ] `terraform validate` passes with no errors\n- [ ] `terraform plan` succeeds (may require credentials setup)\n\n## Context\nOpenSpec: add-fastly-cdn-terraform, Section 6\nParent Epic: mealfinding-cdn-995\nDepends on: All Terraform and VCL configuration tasks","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T18:15:22.396405138-08:00","created_by":"sword","updated_at":"2026-01-04T18:15:22.396405138-08:00","dependencies":[{"issue_id":"mealfinding-cdn-1aq","depends_on_id":"mealfinding-cdn-3y1","type":"blocks","created_at":"2026-01-04T18:15:41.190006657-08:00","created_by":"sword"},{"issue_id":"mealfinding-cdn-1aq","depends_on_id":"mealfinding-cdn-5hk","type":"blocks","created_at":"2026-01-04T18:15:41.337442519-08:00","created_by":"sword"}]}
{"id":"mealfinding-cdn-3y1","title":"Terraform Configuration - providers, variables, main, tls, outputs","description":"## Requirements\n- Create `terraform/providers.tf` with Fastly provider and Tigris S3 backend\n- Create `terraform/variables.tf` with domain, origin, and TTL variables\n- Create `terraform/main.tf` with Fastly VCL service:\n  - Configure domains (apex, www, api)\n  - Configure backends (web_origin, api_origin)\n  - Configure conditions for routing and content types\n  - Configure cache settings per content type\n  - Configure security headers (HSTS, CSP, X-Frame-Options, etc.)\n  - Configure gzip compression\n- Create `terraform/tls.tf` with TLS subscription for Let's Encrypt\n- Create `terraform/outputs.tf` with service ID, domains, CNAME, TLS challenges\n\n## Acceptance Criteria\n- [ ] providers.tf has Fastly provider \u003e= 5.0.0\n- [ ] providers.tf has S3 backend pointing to fly.storage.tigris.dev\n- [ ] variables.tf defines service_name, domain_name, web_origin, api_origin, TTL vars\n- [ ] main.tf creates fastly_service_vcl resource with all domains and backends\n- [ ] tls.tf creates fastly_tls_subscription for Let's Encrypt certificates\n- [ ] outputs.tf exports service_id, domains, fastly_cname, tls_dns_challenges\n\n## Context\nOpenSpec: add-fastly-cdn-terraform, Section 3\nParent Epic: mealfinding-cdn-995\nDepends on: Project Setup, VCL Configuration (main.tf references VCL file)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T18:14:57.27029584-08:00","created_by":"sword","updated_at":"2026-01-04T18:14:57.27029584-08:00","dependencies":[{"issue_id":"mealfinding-cdn-3y1","depends_on_id":"mealfinding-cdn-9h0","type":"blocks","created_at":"2026-01-04T18:15:41.024105121-08:00","created_by":"sword"},{"issue_id":"mealfinding-cdn-3y1","depends_on_id":"mealfinding-cdn-5hk","type":"blocks","created_at":"2026-01-04T18:15:41.105333753-08:00","created_by":"sword"}]}
{"id":"mealfinding-cdn-5hk","title":"VCL Configuration - Routing, caching, and error handling","description":"## Requirements\n- Create `terraform/vcl/` directory\n- Create `terraform/vcl/main.vcl` with:\n  - Subdomain-based backend routing (vcl_recv)\n  - HTTPS redirect logic\n  - Cache key optimization (vcl_hash)\n  - Content-type TTL rules (vcl_fetch)\n  - Cache status headers (vcl_deliver)\n  - Custom error pages (vcl_error)\n\n## Acceptance Criteria\n- [ ] vcl_recv routes api.mealfinding.com to api_origin backend\n- [ ] vcl_recv routes www/apex to web_origin backend\n- [ ] HTTP requests redirect to HTTPS (301)\n- [ ] vcl_hash includes host for cache key separation\n- [ ] vcl_fetch sets 24h TTL for static assets, 1h for HTML\n- [ ] vcl_deliver adds X-Cache and X-Cache-Hits headers\n- [ ] vcl_error returns custom 404 and 503 pages\n\n## Context\nOpenSpec: add-fastly-cdn-terraform, Section 4\nParent Epic: mealfinding-cdn-995\nDepends on: Project Setup","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T18:15:04.760516796-08:00","created_by":"sword","updated_at":"2026-01-04T18:15:04.760516796-08:00","dependencies":[{"issue_id":"mealfinding-cdn-5hk","depends_on_id":"mealfinding-cdn-9h0","type":"blocks","created_at":"2026-01-04T18:15:40.954477324-08:00","created_by":"sword"}]}
{"id":"mealfinding-cdn-995","title":"Add Fastly CDN Terraform Infrastructure","description":"## Overview\nImplement Terraform configuration for Fastly CDN to serve mealfinding.com\n\n## OpenSpec Change\n`add-fastly-cdn-terraform`\n\n## Scope\n- Terraform state backend (Tigris)\n- Fastly VCL service configuration\n- Custom VCL routing and caching\n- TLS certificates (Let's Encrypt)\n- Security headers\n- Documentation\n\n## Domains\n- mealfinding.com (apex)\n- www.mealfinding.com\n- api.mealfinding.com\n\n## Origins\n- mealfinding-web.fly.dev (web frontend)\n- mealfinding-api.fly.dev (REST API)\n\n## Reference\n- Proposal: openspec/changes/add-fastly-cdn-terraform/proposal.md\n- Design: openspec/changes/add-fastly-cdn-terraform/design.md\n- Tasks: openspec/changes/add-fastly-cdn-terraform/tasks.md","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-04T18:13:54.541672166-08:00","created_by":"sword","updated_at":"2026-01-04T18:13:54.541672166-08:00"}
{"id":"mealfinding-cdn-9h0","title":"Project Setup - Directory structure and .gitignore","description":"## Requirements\n- Update `.gitignore` with Terraform patterns (*.tfstate, .terraform/, *.tfvars, .env)\n- Create `terraform/` directory structure\n- Create `scripts/` directory\n\n## Acceptance Criteria\n- [ ] .gitignore includes all Terraform-related patterns\n- [ ] terraform/ directory exists\n- [ ] scripts/ directory exists\n\n## Context\nOpenSpec: add-fastly-cdn-terraform, Section 1\nParent Epic: mealfinding-cdn-995","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T18:14:40.071553248-08:00","created_by":"sword","updated_at":"2026-01-04T18:14:40.071553248-08:00"}
{"id":"mealfinding-cdn-f65","title":"State Backend Setup - Tigris bucket and credentials","description":"## Requirements\n- Create `scripts/setup-tigris.sh` to provision Tigris bucket\n- Document Tigris credential setup in README\n\n## Acceptance Criteria\n- [ ] setup-tigris.sh creates bucket named `mealfinding-terraform-state`\n- [ ] Script outputs credentials (AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY)\n- [ ] README documents environment variable setup\n\n## Context\nOpenSpec: add-fastly-cdn-terraform, Section 2\nParent Epic: mealfinding-cdn-995\nDepends on: Project Setup task","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T18:14:49.526550874-08:00","created_by":"sword","updated_at":"2026-01-04T18:14:49.526550874-08:00","dependencies":[{"issue_id":"mealfinding-cdn-f65","depends_on_id":"mealfinding-cdn-9h0","type":"blocks","created_at":"2026-01-04T18:15:40.802100733-08:00","created_by":"sword"}]}
